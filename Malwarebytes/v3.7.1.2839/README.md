# v3.7.1.2839

# Malicious Code Bypass via Extension Whitelisting 

## Issues

1. Does not proactively scan files dropped to disk,
2. Executables with `etl`, `Config`, and `Manifest` file extensions ran using `CreateProcess` do not get scanned.

### Recommended Fix(?)

1. Include `IRP_MJ_CLEANUP` (and optionally `IRP_MJ_WRITE`) minifilter callback operations,
2. Do not whitelist `etl`, `Config`, and `Manifest` file extensions from scanning.

### Tested Environments

* Windows 7 x64 Home Premium
* Windows 7 x64 Ultimate
* Windows 10 x64 Pro

## How to Compile

MSVS :')

## How to Use:

The application is both the builder and dropper. The following instructions detail how to build and run the dropper:

### Building the dropper:

Options:

```
> MBAM_3_7_1_2839_Bypass.exe -p <PAYLOAD EXE> [-o <OUTPUT FILE>]
```

Example:

```
> MBAM_3_7_1_2839_Bypass.exe -p mypayload.exe -o out.exe
```

### Using the dropper:

Run the built payload:

```
> out.exe
```


## Demo

![demo](https://image.prntscr.com/image/s2WOwStiR7_uacVQZFGHyQ.gif)
